(function(e){function n(n){for(var a,r,c=n[0],s=n[1],i=n[2],h=0,f=[];h<c.length;h++)r=c[h],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);u&&u(n);while(f.length)f.shift()();return l.push.apply(l,i||[]),t()}function t(){for(var e,n=0;n<l.length;n++){for(var t=l[n],a=!0,c=1;c<t.length;c++){var s=t[c];0!==o[s]&&(a=!1)}a&&(l.splice(n--,1),e=r(r.s=t[0]))}return e}var a={},o={app:0},l=[];function r(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=a,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)r.d(t,a,function(n){return e[n]}.bind(null,a));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=n,c=c.slice();for(var i=0;i<c.length;i++)n(c[i]);var u=s;l.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"034f":function(e,n,t){"use strict";t("85ec")},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var a=t("2b0e"),o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("b-container",{attrs:{id:"app",fluid:""}},[t("LiveChannelList",{on:{selectChannel:e.selectChannel}}),t("Player",{attrs:{channel:e.channel}})],1)},l=[],r=(t("b0c0"),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("b-embed",{attrs:{type:"iframe",aspect:"16by9",src:e.playerUrl,allow:"autoplay",allowfullscreen:""}}),t("b-row",[t("b-col",[t("b-card",{attrs:{title:"플레이어 주소"}},[t("b-card-text",[e._v(" "+e._s(e.playerUrl)+" ")])],1)],1),t("b-col",[t("b-card",{attrs:{title:"토큰 페이로드"}},[t("b-card-text",[e._v(" "+e._s(e.payload)+" ")])],1)],1),t("b-col",[t("b-form-checkbox",{attrs:{value:"true","unchecked-value":"false"},model:{value:e.anonymousChat,callback:function(n){e.anonymousChat=n},expression:"anonymousChat"}},[e._v(" Guest 모드 채팅 참여자 ")]),t("b-form-checkbox",{attrs:{value:"true","unchecked-value":"false"},model:{value:e.overlayChat,callback:function(n){e.overlayChat=n},expression:"overlayChat"}},[e._v(" 가로 라이브 오버레이 강제 ")]),t("b-form-checkbox",{attrs:{value:"true","unchecked-value":"false"},model:{value:e.disableBlock,callback:function(n){e.disableBlock=n},expression:"disableBlock"}},[e._v(" 참여자 차단방지 ")])],1)],1)],1)}),c=[],s=(t("d3b7"),t("25f0"),{name:"Player",props:{channel:Object},data:function(){return{playerUrl:"",payload:{},anonymousChat:!1,overlayChat:!1,disableBlock:!1}},watch:{channel:function(e,n){e.key===n.key&&e.onair===n.onair||this.getPlayerUrl()},anonymousChat:function(e,n){e!==n&&this.getPlayerUrl()},overlayChat:function(e,n){e!==n&&this.getPlayerUrl()},disableBlock:function(e,n){e!==n&&this.getPlayerUrl()}},methods:{getPlayerUrl:function(){var e=this,n={};n["client_user_id"]=Math.random().toString(36).substr(2,11),n["live_media_channel_key"]=this.channel.key,this.channel.chatting&&(n["client_user_name"]="채팅사용자_"+n["client_user_id"],n["client_user_image"]="https://mblogthumb-phinf.pstatic.net/20150202_133/chaejhh_1422874976243x0rSA_JPEG/%253F%253F%253F%25CE%25B1%253F3_edit.jpg?type=w800"),this.$http.get("/api/player/live",{params:n}).then((function(n){var t=n.data.url;e.anonymousChat&&(t+="&anonymous_chat"),e.overlayChat&&(t+="&landscape_overlay"),e.disableBlock&&(t+="&disable_block"),e.playerUrl=t,e.payload=JSON.parse(n.data.payload)}))}},updated:function(){console.log("update!!!")}}),i=s,u=t("2877"),h=Object(u["a"])(i,r,c,!1,null,"ea94c750",null),f=h.exports,d=function(){var e=this,n=e.$createElement,t=e._self._c||n;return e.hasChannels?t("b-navbar",{attrs:{toggleable:"",variant:"primary"}},[t("b-navbar-brand",[e._v("채널목록")]),t("b-navbar-toggle",{attrs:{target:"navbar-toggle-collapse"},scopedSlots:e._u([{key:"default",fn:function(n){var a=n.expanded;return[a?t("b-icon",{attrs:{icon:"chevron-bar-up"}},[e._v("감추기")]):t("b-icon",{attrs:{icon:"chevron-bar-down"}},[e._v("펼치기")])]}}],null,!1,1298988007)}),t("b-collapse",{attrs:{id:"navbar-toggle-collapse","is-nav":""}},[t("b-navbar-nav",{staticClass:"ml-auto"},e._l(e.channels,(function(n){return t("b-nav-item",{key:n.key,on:{click:function(t){return e.selectChannel(n)}}},[e._v(" "+e._s(n.name)+" "),n.onair?t("b-badge",{attrs:{variant:"danger"}},[e._v("방송중")]):e._e(),n.chatting?t("b-badge",{attrs:{variant:"warning"}},[e._v("채팅")]):e._e()],1)})),1)],1)],1):t("span",{on:{click:e.listChannel}},[e._v("정보가 없습니다.")])},p=[],b={name:"LiveChannelList",data:function(){return{channels:[]}},created:function(){this.listChannel()},computed:{hasChannels:function(){return console.log("hasChannels",this.channels.length>0),this.channels.length>0}},methods:{listChannel:function(){var e=this;this.$http.get("/api/live/channel").then((function(n){e.channels=n.data,console.log(e.channels)}))},selectChannel:function(e){this.$emit("selectChannel",e)}},mounted:function(){}},v=b,y=Object(u["a"])(v,d,p,!1,null,"8d6fe9b6",null),g=y.exports,_={name:"App",components:{Player:f,LiveChannelList:g},data:function(){return{channel:{}}},methods:{selectChannel:function(e){this.channel=e},websocketConnect:function(){var e=this;"http:"===window.location.protocol?this.socket=new WebSocket("ws://"+window.location.host+"/ws"):this.socket=new WebSocket("wss://"+window.location.host+"/ws"),this.socket.onopen=function(){console.log("WSS CONNECTED"),e.socket.onmessage=function(n){var t=JSON.parse(n.data),a=t["channel_key"],o=t["broadcast_state"];if(console.log(e.channel.key,e.channel.onair),console.log(a,o),e.channel.key===a){var l={};l.key=a,l.name=e.channel.name,l.chatting=e.channel.chatting,"start"===o||"resume"===o?(l.onair=!0,console.log("start")):(l.onair=!1,console.log("end")),console.log(l),e.channel=l}}}},websocketDisconnect:function(){this.socket.close()}},created:function(){this.websocketConnect()},beforeDestroy:function(){this.websocketDisconnect()}},m=_,k=(t("034f"),Object(u["a"])(m,o,l,!1,null,null,null)),w=k.exports,C=t("bc3a"),x=t.n(C),O=t("5f5b");t("ab8b"),t("2dd8");a["default"].use(O["a"]),a["default"].config.productionTip=!1,a["default"].prototype.$http=x.a,new a["default"]({render:function(e){return e(w)}}).$mount("#app")},"85ec":function(e,n,t){}});
//# sourceMappingURL=app.edc7826b.js.map